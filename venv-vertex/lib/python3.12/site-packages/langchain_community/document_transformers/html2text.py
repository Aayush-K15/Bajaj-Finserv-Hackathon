from typing import Any, Sequence

from langchain_core.documents import BaseDocumentTransformer, Document


class Html2TextTransformer(BaseDocumentTransformer):
    

    def __init__(self, ignore_links: bool = True, ignore_images: bool = True) -> None:
        self.ignore_links = ignore_links
        self.ignore_images = ignore_images

    def transform_documents(
        self,
        documents: Sequence[Document],
        **kwargs: Any,
    ) -> Sequence[Document]:
        try:
            import html2text
        except ImportError:
            raise ImportError(
                
            )

        
        h = html2text.HTML2Text()
        h.ignore_links = self.ignore_links
        h.ignore_images = self.ignore_images

        new_documents = []

        for d in documents:
            new_document = Document(
                page_content=h.handle(d.page_content), metadata={**d.metadata}
            )
            new_documents.append(new_document)
        return new_documents

    async def atransform_documents(
        self,
        documents: Sequence[Document],
        **kwargs: Any,
    ) -> Sequence[Document]:
        raise NotImplementedError
