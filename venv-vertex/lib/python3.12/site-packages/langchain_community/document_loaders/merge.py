from typing import AsyncIterator, Iterator, List

from langchain_core.documents import Document

from langchain_community.document_loaders.base import BaseLoader


class MergedDataLoader(BaseLoader):
    

    def __init__(self, loaders: List):
        
        self.loaders = loaders

    def lazy_load(self) -> Iterator[Document]:
        
        for loader in self.loaders:
            
            try:
                data = loader.lazy_load()
            except NotImplementedError:
                data = loader.load()
            for document in data:
                yield document

    async def alazy_load(self) -> AsyncIterator[Document]:
        
        for loader in self.loaders:
            async for document in loader.alazy_load():
                yield document
