import csv
from pathlib import Path
from typing import List, Union

from langchain_core.documents import Document

from langchain_community.document_loaders.base import BaseLoader


class CoNLLULoader(BaseLoader):
    

    def __init__(self, file_path: Union[str, Path]):
        
        self.file_path = file_path

    def load(self) -> List[Document]:
        
        with open(self.file_path, encoding="utf8") as f:
            tsv = list(csv.reader(f, delimiter="\t"))

            
            lines = [line for line in tsv if len(line) > 1]

        text = ""
        for i, line in enumerate(lines):
            
            if line[9] == "SpaceAfter=No" or i == len(lines) - 1:
                text += line[1]
            else:
                text += line[1] + " "

        metadata = {"source": str(self.file_path)}
        return [Document(page_content=text, metadata=metadata)]
