

from typing import List

from langchain_core.embeddings import Embeddings


class Model2vecEmbeddings(Embeddings):
    

    def __init__(self, model: str):
        
        try:
            from model2vec import StaticModel
        except ImportError as e:
            raise ImportError(
                "Unable to import model2vec, please install with "
                "`pip install -U model2vec`."
            ) from e
        self._model = StaticModel.from_pretrained(model)

    def embed_documents(self, texts: List[str]) -> List[List[float]]:
        

        return self._model.encode(texts).tolist()

    def embed_query(self, text: str) -> List[float]:
        

        return self._model.encode(text).tolist()
