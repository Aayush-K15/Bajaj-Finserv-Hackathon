import http

from .. import datastructures
from ..exceptions import (
    InvalidHandshake,
    
    InvalidMessage,  
    ProtocolError as WebSocketProtocolError,  
)
from ..typing import StatusLike


class InvalidStatusCode(InvalidHandshake):
    

    def __init__(self, status_code: int, headers: datastructures.Headers) -> None:
        self.status_code = status_code
        self.headers = headers

    def __str__(self) -> str:
        return f"server rejected WebSocket connection: HTTP {self.status_code}"


class AbortHandshake(InvalidHandshake):
    

    def __init__(
        self,
        status: StatusLike,
        headers: datastructures.HeadersLike,
        body: bytes = b"",
    ) -> None:
        
        self.status = http.HTTPStatus(status)
        self.headers = datastructures.Headers(headers)
        self.body = body

    def __str__(self) -> str:
        return (
            f"HTTP {self.status:d}, {len(self.headers)} headers, {len(self.body)} bytes"
        )


class RedirectHandshake(InvalidHandshake):
    

    def __init__(self, uri: str) -> None:
        self.uri = uri

    def __str__(self) -> str:
        return f"redirect to {self.uri}"
