__all__ = [
    'WebAttachment',
]


import functools

from typing import Optional

from .. import constants
from .attachment_base import AttachmentBase
from ..enums import AttachmentPermissionType, AttachmentType, SaveType


class WebAttachment(AttachmentBase):
    

    def getFilename(self) -> str:
        raise NotImplementedError('Cannot get the filename of a web attachment.')

    def save(self, **kwargs) -> constants.SAVE_TYPE:
        
        if kwargs.get('skipNotImplemented', False):
            return (SaveType.NONE, None)

        raise NotImplementedError('Web attachments cannot be saved.')

    @property
    def data(self) -> None:
        
        raise NotImplementedError('Cannot get the data of a web attachment.')

    @functools.cached_property
    def originalPermissionType(self) -> Optional[AttachmentPermissionType]:
        
        return self.getNamedAs('AttachmentOriginalPermissionType', constants.ps.PSETID_ATTACHMENT, AttachmentPermissionType)

    @functools.cached_property
    def permissionType(self) -> Optional[AttachmentPermissionType]:
        
        return self.getNamedAs('AttachmentPermissionType', constants.ps.PSETID_ATTACHMENT, AttachmentPermissionType)

    @functools.cached_property
    def providerName(self) -> Optional[str]:
        
        return self.getNamedProp('AttachmentProviderType', constants.ps.PSETID_ATTACHMENT)

    @property
    def type(self) -> AttachmentType:
        return AttachmentType.WEB

    @property
    def url(self) -> Optional[str]:
        
        return self.longPathname