
from . import pool
from .._compat import queue


def map(requests, **kwargs):
    r
    if not (requests and all(isinstance(r, dict) for r in requests)):
        raise ValueError('map expects a list of dictionaries.')

    
    job_queue = queue.Queue()
    for request in requests:
        job_queue.put(request)

    
    kwargs['job_queue'] = job_queue

    threadpool = pool.Pool(**kwargs)
    threadpool.join_all()
    return threadpool.responses(), threadpool.exceptions()
