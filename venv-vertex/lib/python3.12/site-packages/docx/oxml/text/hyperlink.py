

from __future__ import annotations

from typing import TYPE_CHECKING, List

from docx.oxml.simpletypes import ST_OnOff, ST_String, XsdString
from docx.oxml.text.run import CT_R
from docx.oxml.xmlchemy import (
    BaseOxmlElement,
    OptionalAttribute,
    ZeroOrMore,
)

if TYPE_CHECKING:
    from docx.oxml.text.pagebreak import CT_LastRenderedPageBreak


class CT_Hyperlink(BaseOxmlElement):
    

    r_lst: List[CT_R]

    rId: str | None = OptionalAttribute("r:id", XsdString)  
    anchor: str | None = OptionalAttribute(  
        "w:anchor", ST_String
    )
    history: bool = OptionalAttribute(  
        "w:history", ST_OnOff, default=True
    )

    r = ZeroOrMore("w:r")

    @property
    def lastRenderedPageBreaks(self) -> List[CT_LastRenderedPageBreak]:
        
        return self.xpath("./w:r/w:lastRenderedPageBreak")

    @property
    def text(self) -> str:  
        
        return "".join(r.text for r in self.xpath("w:r"))
