
















import re

from google.cloud.aiplatform.compat.types import (
    pipeline_state as gca_pipeline_state,
)

_PIPELINE_COMPLETE_STATES = set(
    [
        gca_pipeline_state.PipelineState.PIPELINE_STATE_SUCCEEDED,
        gca_pipeline_state.PipelineState.PIPELINE_STATE_FAILED,
        gca_pipeline_state.PipelineState.PIPELINE_STATE_CANCELLED,
        gca_pipeline_state.PipelineState.PIPELINE_STATE_PAUSED,
    ]
)

_PIPELINE_ERROR_STATES = set([gca_pipeline_state.PipelineState.PIPELINE_STATE_FAILED])


_VALID_NAME_PATTERN = re.compile("^[a-z][-a-z0-9]{0,127}$", re.IGNORECASE)


_VALID_AR_URL = re.compile(r"^https:\/\/([\w-]+)-kfp\.pkg\.dev\/.*", re.IGNORECASE)


_VALID_HTTPS_URL = re.compile(r"^https:\/\/([\.\/\w-]+)\/.*(json|yaml|yml)$")


_READ_MASK_FIELDS = [
    "name",
    "state",
    "display_name",
    "pipeline_spec.pipeline_info",
    "create_time",
    "start_time",
    "end_time",
    "update_time",
    "labels",
    "template_uri",
    "template_metadata.version",
    "job_detail.pipeline_run_context",
    "job_detail.pipeline_context",
]
