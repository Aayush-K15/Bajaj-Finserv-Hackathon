
















from typing import Optional

from google.cloud.aiplatform import explain
from google.cloud.aiplatform.compat.types import (
    endpoint as gca_endpoint_compat,
)


def create_and_validate_explanation_spec(
    explanation_metadata: Optional[explain.ExplanationMetadata] = None,
    explanation_parameters: Optional[explain.ExplanationParameters] = None,
) -> Optional[explain.ExplanationSpec]:
    
    if bool(explanation_metadata) and not bool(explanation_parameters):
        raise ValueError(
            "To get model explanation, `explanation_parameters` must be specified."
        )

    if explanation_parameters:
        explanation_spec = gca_endpoint_compat.explanation.ExplanationSpec()
        explanation_spec.parameters = explanation_parameters
        if explanation_metadata:
            explanation_spec.metadata = explanation_metadata
        return explanation_spec

    return None
