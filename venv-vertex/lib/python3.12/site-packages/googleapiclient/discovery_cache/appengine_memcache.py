















import logging



from google.appengine.api import memcache

from . import base
from ..discovery_cache import DISCOVERY_DOC_MAX_AGE

LOGGER = logging.getLogger(__name__)

NAMESPACE = "google-api-client"


class Cache(base.Cache):
    

    def __init__(self, max_age):
        
        self._max_age = max_age

    def get(self, url):
        try:
            return memcache.get(url, namespace=NAMESPACE)
        except Exception as e:
            LOGGER.warning(e, exc_info=True)

    def set(self, url, content):
        try:
            memcache.set(url, content, time=int(self._max_age), namespace=NAMESPACE)
        except Exception as e:
            LOGGER.warning(e, exc_info=True)


cache = Cache(max_age=DISCOVERY_DOC_MAX_AGE)
