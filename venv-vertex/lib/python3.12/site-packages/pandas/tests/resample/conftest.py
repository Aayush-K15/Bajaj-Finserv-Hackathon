from datetime import datetime

import numpy as np
import pytest

from pandas import (
    DataFrame,
    Series,
)


downsample_methods = [
    "min",
    "max",
    "first",
    "last",
    "sum",
    "mean",
    "sem",
    "median",
    "prod",
    "var",
    "std",
    "ohlc",
    "quantile",
]
upsample_methods = ["count", "size"]
series_methods = ["nunique"]
resample_methods = downsample_methods + upsample_methods + series_methods


@pytest.fixture(params=downsample_methods)
def downsample_method(request):
    
    return request.param


@pytest.fixture(params=resample_methods)
def resample_method(request):
    
    return request.param


@pytest.fixture
def _index_start():
    
    return datetime(2005, 1, 1)


@pytest.fixture
def _index_end():
    
    return datetime(2005, 1, 10)


@pytest.fixture
def _index_freq():
    
    return "D"


@pytest.fixture
def _index_name():
    
    return None


@pytest.fixture
def index(_index_factory, _index_start, _index_end, _index_freq, _index_name):
    
    return _index_factory(_index_start, _index_end, freq=_index_freq, name=_index_name)


@pytest.fixture
def _static_values(index):
    
    return np.arange(len(index))


@pytest.fixture
def _series_name():
    
    return None


@pytest.fixture
def series(index, _series_name, _static_values):
    
    return Series(_static_values, index=index, name=_series_name)


@pytest.fixture
def empty_series_dti(series):
    
    return series[:0]


@pytest.fixture
def frame(index, _series_name, _static_values):
    
    
    return DataFrame({"value": _static_values}, index=index)


@pytest.fixture
def empty_frame_dti(series):
    
    index = series.index[:0]
    return DataFrame(index=index)


@pytest.fixture
def series_and_frame(frame_or_series, series, frame):
    
    if frame_or_series == Series:
        return series
    if frame_or_series == DataFrame:
        return frame
